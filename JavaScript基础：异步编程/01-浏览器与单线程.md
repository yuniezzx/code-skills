JavaScript 代码一般运行在浏览器中或本地 Nodejs 环境中。之所以能在浏览器中运行，是因为浏览器内置了一个 JavaScript 引擎。这个引擎负责解释和执行 JavaScript 代码。

## 浏览器的进程架构
浏览器的进程架构是现代浏览器设计中的一个关键部分，它确保了浏览器的稳定性、安全性和性能。以下是浏览器进程架构的描述：
1. 主进程（Browser Process）：只有一个主进程。负责启动和管理其他进程，如渲染进程和插件进程。处理与操作系统的交互，如文件系统、网络接口等。
2. 渲染进程（Renderer Process）：渲染网页的内容，包括 HTML、CSS 和 JavaScript 。每个标签页或网页通常对应一个独立的渲染进程。渲染进程是多线程的，内部包括多个线程，如 JavaScript 执行线程、渲染线程、布局线程等。
3. GPU 进程：处理图形渲染和硬件加速任务。通常有一个 GPU 进程，负责所有图形渲染任务。通过与渲染进程的通信来优化绘图和渲染性能。
4. 第三方插件进程：管理浏览器插件（如 Flash、Java 插件）的执行。每种插件类型通常会有一个独立的进程。
5. 网络进程：处理网络请求和响应，负责下载和上传数据。管理浏览器的缓存和网络策略。

不同进程之间通过进程间通信（IPC）机制进行数据交换和消息传递。浏览器的 IPC 机制确保了各进程之间的协调和数据一致性，同时提高了浏览器的安全性和稳定性。

### 渲染进程
在现代浏览器中，CSS、HTML 和 JavaScript 主要在渲染进程中处理。浏览器的渲染进程是多线程的。
1. GUI 渲染线程：负责渲染浏览器界面，解析HTML、CSS、构建DOM树、构建CSS树构建渲染树和绘制页面； 当界面需要重绘或由于某种操作引发回流时，该线程就会执行。
2. JavaScript 引擎线程：也称为 JavaScript 内核，负责处理 Javascript 脚本程序、解析 Javascript 脚本、运行代码等。（例如 V8 引擎）
3. 定时触发器线程：传说中的 setInterval 与 setTimeout 所在线程，注意，W3C 在 HTML 标准中规定，规定要求 setTimeout 中低于 4ms 的时间间隔算为 4ms 。
4. 异步 http 请求线程：在 XMLHttpRequest 连接后通过浏览器新开一个线程请求，将检测到状态变更时，如果设置有回调函数，异步线程就产生状态变更事件，将这个回调再放入事件队列中。再由 JavaScript 引擎执行。

> 注意，GUI 渲染线程与 JavaScript 引擎线程是互斥的，当 JavaScript 引擎执行时 GUI 线程会被挂起（相当于被冻结了），GUI 更新会被保存在一个队列中等到 JavaScript 引擎空闲时立即被执行。所以如果 JavaScript 执行的时间过长，这样就会造成页面的渲染不连贯，导致页面渲染加载阻塞。

### 单线程的JavaScript
所谓单线程，是指在 JavaScript 引擎中负责解释和执行 JavaScript 代码的线程，同一时间上只能执行一件任务。而事件在触发后，也是将事件添加到队列末尾。

> JavaScript引擎处理代码的线程是唯一的，这个线程称为主线程。

单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。
由于 JavaScript 是单线程的，所有的操作都按照代码书写的顺序逐一执行。这确保了操作的顺序性，但也意味着长时间运行的任务会阻塞后续任务的执行。

这也导致线程中运行时间过长，它会阻塞其他操作，比如用户界面的更新和事件的处理。这可能导致页面变得无响应。

所以在主线程中排队执行的任务，也就是同步任务。（那所谓的异步任务就是不进入主线程，而进入任务队列。）

示例：同步代码执行
```javascript
console.log('Start');

for (let i = 0; i < 1000000000; i++) {
  // 大量循环操作，模拟长时间的计算
}

console.log('End');
```
执行流程：
1. console.log('Start') 在主线程中立即执行。
2. 进入循环，长时间计算导致主线程被阻塞。
3. console.log('End') 直到循环完成后才执行。

在循环执行期间，页面可能会变得无响应，用户不能进行任何交互。




### 参考链接

- [前端必知必会之 JS 单线程与异步](https://juejin.cn/post/6844903574133014542) 
- [Why JavaScript is Single Threaded?](https://groovetechnology.com/blog/why-javascript-is-single-threaded/)
- 